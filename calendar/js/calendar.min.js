(function(e,c,a,g){var d="nicoCalendar";var f={langFr:{days:["l","ma","me","j","v","s","d"],monthes:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"]},prefix:"nc-calendar__",startDate:null,endDate:null,onChange:function(h){},onMonthChange:function(i,h){}};function b(i,h){this.el=i;this.$el=e(i);this.opt=e.extend(true,{},f,h);this.initVars();this.build()}b.prototype={initVars:function(){this.startDate=null;if(this.opt.startDate!=null){var i={};i[this.opt.startDate[1]]=this.opt.startDate[0];this.startDate=moment(this.today).add(moment.duration(i))}if(this.opt.endDate!=null){var h={};h[this.opt.endDate[1]]=this.opt.endDate[0];this.endDate=moment(this.today).add(moment.duration(h));console.log(this.endDate)}this.today=new Date();this.currentDate=this.today.getDate();this.currentMonth=this.today.getMonth();this.currentYear=this.today.getFullYear();this.activeDay=this.today},build:function(){var h,i,l;i=this.opt;l=i.prefix;this.root=e("<div/>",{"class":"nc-calendar"});this.header=e("<div/>",{"class":l+"header"});this.prevMonth=e("<div/>",{"class":l+"col "+l+"left"}).html("<i class='fa fa-chevron-left'></i>");this.current=e("<div/>",{"class":l+"current"});this.nextMonth=e("<div/>",{"class":l+"col "+l+"right"}).html("<i class='fa fa-chevron-right'></i>");this.header.append(this.prevMonth,this.current,this.nextMonth);this.dayNames=e("<div/>",{"class":l+"day-names"});for(var k=0;k<7;k++){var m=l+"col "+l+"day-name";var j=e("<div/>",{"class":m,text:i.langFr.days[k]});this.dayNames.append(j)}this.days=e("<div/>",{"class":i.prefix+"days"});this.root.append(this.header,this.dayNames,this.days);this.$el.append(this.root);this.updateMonth();h=this;this.current.on("click",function(n){n.preventDefault();h.setDate(moment(h.today).format("YYYY-MM-DD"))});this.prevMonth.on("click",function(n){n.preventDefault();h.updateMonth(-1)});this.nextMonth.on("click",function(n){n.preventDefault();h.updateMonth(1)})},updateMonth:function(h){if(!h){h=0}this.currentMonth+=h;if(this.currentMonth<0){this.currentMonth=11;this.updateYear(-1)}else{if(this.currentMonth>11){this.currentMonth=0;this.updateYear(1)}}this.opt.onMonthChange(this.currentMonth,this.currentYear);this.deactiveDay();this.changeHeader();this.update()},updateYear:function(h){this.currentYear+=h},changeHeader:function(){this.current.text(this.opt.langFr.monthes[this.currentMonth]+" "+this.currentYear)},update:function(){var j,s,x,l,i,p,u,q,o,v,k;j=this.opt;s=j.prefix;x=this;this.$el.find("."+s+"day").off("click");this.days.empty();this.Datas={};l=moment([this.currentYear,this.currentMonth]).endOf("month").date();i=moment([this.currentYear,this.currentMonth,1]).day();i=(i==0)?6:i-1;p=i;u=moment([this.currentYear,this.currentMonth,l]).day();u=(u==0)?6:u-1;q=6-u;o=p+l+q;v=o/7;k=1;for(var h=0;h<v;h++){var y;y=e("<div/>",{"class":s+"row"});for(var t=0;t<7;t++){var w;w=e("<div/>",{"class":s+"col "+s+"day"});if(h==0&&t<p){w.addClass("empty");w.text("-")}else{if(h==v-1&&t>u){w.addClass("empty");w.text("-")}else{w.text(k);var n;n=moment([this.currentYear,this.currentMonth,k]);this.Datas[k]=n.format("YYYY-MM-DD");if(this.currentMonth==this.today.getMonth()&&this.currentYear==this.today.getFullYear()&&k==this.today.getDate()){w.addClass("today")}if(this.currentMonth==this.activeDay.getMonth()&&this.currentYear==this.activeDay.getFullYear()&&k==this.activeDay.getDate()){w.addClass("active")}if((this.startDate==null||(this.startDate&&n.isSameOrAfter(this.startDate.format("YYYY-MM-DD"))))&&(this.endDate==null||(this.endDate&&n.isSameOrBefore(this.endDate.format("YYYY-MM-DD"))))){w.on("click",function(m){m.preventDefault();x.deactiveDay();x.activateDay(x.Datas[parseInt(e(this).text())]);e(this).addClass("active");x.opt.onChange(x.Datas[parseInt(e(this).text())])})}k++}}y.append(w)}this.days.append(y)}},deactiveDay:function(){this.days.find(".active").removeClass("active")},activateDay:function(h){this.activeDay=new Date(h)},setDate:function(i){var h;this.activateDay(i);h=moment(i);this.currentYear=h.year();this.currentMonth=h.month();this.currentDate=h.date();this.changeHeader();this.update()}};e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))}})}})(jQuery,window,document);